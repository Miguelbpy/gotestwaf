<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GoTestWaf report</title>
    <script src="https://go-echarts.github.io/go-echarts-assets/assets/echarts.min.js"></script>
    <style>
        table, th, td {
            border: 1px solid black;
            word-break: break-all;
            max-width: available;
        }
        code {
            word-break: keep-all;
        }
    </style>
</head>
<body>

<h1>API Security / WAF Testing Results</h1>

<table>
    <tr>
        <td style="vertical-align: top; background-color: {{.Overall.Color}}">
            <table>
                <tr><td>Overall grade:</td></tr>
                <tr><td>{{.Overall.Mark}}</td></tr>
                <tr><td>{{printf "%.1f%%" .Overall.Percentage}} / 100</td></tr>
            </table>
        </td>
        <td>
            <table>
                <tr><td>WAF Name: {{.WafName}}</td></tr>
                <tr><td>URL: {{.Url}}</td></tr>
                <tr><td>WAF Testing Date: {{.WafTestingDate}}</td></tr>
                <tr><td>GoTestWAF version: {{.GtwVersion}}</td></tr>
            </table>
        </td>
    </tr>
</table>

<table>
    <tr>
        <th>Type</th>
        <th>True-negative tests passed</th>
        <th>True-positive tests passed</th>
        <th>Grade</th>
    </tr>
    <tr>
        <td>API Security</td>
        <td style="background-color: {{.ApiSec.TrueNegative.Color}}">{{.ApiSec.TrueNegative.Mark}} ({{printf "%.1f%%" .ApiSec.TrueNegative.Percentage}})</td>
        <td style="background-color: {{.ApiSec.TruePositive.Color}}">{{.ApiSec.TruePositive.Mark}} ({{printf "%.1f%%" .ApiSec.TruePositive.Percentage}})</td>
        <td style="background-color: {{.ApiSec.Grade.Color}}">{{.ApiSec.Grade.Mark}} ({{printf "%.1f%%" .ApiSec.Grade.Percentage}})</td>
    </tr>
    <tr>
        <td>Application Security</td>
        <td style="background-color: {{.AppSec.TrueNegative.Color}}">{{.AppSec.TrueNegative.Mark}} ({{printf "%.1f%%" .AppSec.TrueNegative.Percentage}})</td>
        <td style="background-color: {{.AppSec.TruePositive.Color}}">{{.AppSec.TruePositive.Mark}} ({{printf "%.1f%%" .AppSec.TruePositive.Percentage}})</td>
        <td style="background-color: {{.AppSec.Grade.Color}}">{{.AppSec.Grade.Mark}} ({{printf "%.1f%%" .AppSec.Grade.Percentage}})</td>
    </tr>
</table>

<div class="container">
    <div class="item" id="chart" style="width:900px;height:500px;"></div>
</div>

{{.ChartScript}}

<h2>Benchmarks against other solutions</h2>

<table>
    <tr>
        <th>Type</th>
        <th>API Security</th>
        <th>Application Security</th>
        <th>Overall score</th>
    </tr>
{{range $row := .ComparisonTable}}
    <tr>
        <td>{{$row.Type}}</td>
        <td style="background-color: {{$row.ApiSec.Color}}">{{$row.ApiSec.Mark}} ({{printf "%.1f%%" $row.ApiSec.Percentage}})</td>
        <td style="background-color: {{$row.AppSec.Color}}">{{$row.AppSec.Mark}} ({{printf "%.1f%%" $row.AppSec.Percentage}})</td>
        <td style="background-color: {{$row.OverallScore.Color}}">{{$row.OverallScore.Mark}} ({{printf "%.1f%%" $row.OverallScore.Percentage}})</td>
    </tr>
{{end}}
    <tr>
        <td>Your project</td>
        <td style="background-color: {{.ApiSec.Grade.Color}}">{{.ApiSec.Grade.Mark}} ({{printf "%.1f%%" .ApiSec.Grade.Percentage}})</td>
        <td style="background-color: {{.AppSec.Grade.Color}}">{{.AppSec.Grade.Mark}} ({{printf "%.1f%%" .AppSec.Grade.Percentage}})</td>
        <td style="background-color: {{.Overall.Color}}">{{.Overall.Mark}} ({{printf "%.1f%%" .Overall.Percentage}})</td>
    </tr>
</table>

<h2>Details</h2>

<h3>Summary</h3>

<table>
    <tr>
        <th>Test set</th>
        <th>Test case</th>
        <th>Percentage</th>
        <th>Blocked</th>
        <th>Bypassed</th>
    {{if not .IgnoreUnresolved}}
        <th>Unresolved</th>
    {{end}}
        <th>Sent</th>
        <th>Failed</th>
    </tr>
{{range $row := .SummaryTable}}
    <tr>
        <td>{{$row.TestSet}}</td>
        <td>{{$row.TestCase}}</td>
        <td>{{printf "%.2f%%" $row.Percentage}}</td>
        <td>{{$row.Blocked}}</td>
        <td>{{$row.Bypassed}}</td>
    {{if not $.IgnoreUnresolved}}
        <td>{{$row.Unresolved}}</td>
    {{end}}
        <td>{{$row.Sent}}</td>
        <td>{{$row.Failed}}</td>
    </tr>
{{end}}
</table>

<h3>Positive Tests</h3>

<p>{{.PositiveTests.BlockedRequestsNumber}} false positive requests identified as blocked (failed, bad behavior)</p>

{{if .PositiveTests.BlockedRequestsNumber}}
<table>
    <tr>
        <th>Payload</th>
        <th>Test case</th>
        <th>Encoder</th>
        <th>Placeholder</th>
        <th>Status</th>
    </tr>
{{range $row := .PositiveTests.Blocked}}
    <tr>
        <td><code>{{$row.Payload}}</code></td>
        <td>{{$row.TestCase}}</td>
        <td>{{$row.Encoder}}</td>
        <td>{{$row.Placeholder}}</td>
        <td>{{$row.Status}}</td>
    </tr>
{{end}}
</table>
{{end}}

<p>{{.PositiveTests.BypassedRequestsNumber}} true positive requests identified as bypassed (passed, good behavior)</p>

{{if .PositiveTests.BypassedRequestsNumber}}
<table>
    <tr>
        <th>Payload</th>
        <th>Test case</th>
        <th>Encoder</th>
        <th>Placeholder</th>
        <th>Status</th>
    </tr>
{{range $row := .PositiveTests.Bypassed}}
    <tr>
        <td><code>{{$row.Payload}}</code></td>
        <td>{{$row.TestCase}}</td>
        <td>{{$row.Encoder}}</td>
        <td>{{$row.Placeholder}}</td>
        <td>{{$row.Status}}</td>
    </tr>
{{end}}
</table>
{{end}}

{{if .PositiveTests.UnresolvedRequestsNumber}}
<p>{{.PositiveTests.UnresolvedRequestsNumber}} true positive requests identified as bypassed (passed, good behavior)</p>

<table>
    <tr>
        <th>Payload</th>
        <th>Test case</th>
        <th>Encoder</th>
        <th>Placeholder</th>
        <th>Status</th>
    </tr>
{{range $row := .PositiveTests.Unresolved}}
    <tr>
        <td><code>{{$row.Payload}}</code></td>
        <td>{{$row.TestCase}}</td>
        <td>{{$row.Encoder}}</td>
        <td>{{$row.Placeholder}}</td>
        <td>{{$row.Status}}</td>
    </tr>
{{end}}
</table>
{{end}}

{{if .PositiveTests.FailedRequestsNumber}}
<p>{{.PositiveTests.FailedRequestsNumber}} failed requests</p>

<table>
    <tr>
        <th>Payload</th>
        <th>Test case</th>
        <th>Encoder</th>
        <th>Placeholder</th>
    </tr>
{{range $row := .PositiveTests.Failed}}
    <tr>
        <td><code>{{$row.Payload}}</code></td>
        <td>{{$row.TestCase}}</td>
        <td>{{$row.Encoder}}</td>
        <td>{{$row.Placeholder}}</td>
    </tr>
    <tr>
        <td colspan="4">{{$row.Reason}}</td>
    </tr>
{{end}}
</table>
{{end}}

<h3>Bypasses in Details</h3>

<p>{{.NegativeTests.BypassedRequestsNumber}} malicious requests have bypassed the WAF</p>

{{if .NegativeTests.BypassedRequestsNumber}}
<table>
    <tr>
        <th>Payload</th>
        <th>Test case</th>
        <th>Encoder</th>
        <th>Placeholder</th>
        <th>Status</th>
    </tr>
{{range $row := .NegativeTests.Blocked}}
    <tr>
        <td><code>{{$row.Payload}}</code></td>
        <td>{{$row.TestCase}}</td>
        <td>{{$row.Encoder}}</td>
        <td>{{$row.Placeholder}}</td>
        <td>{{$row.Status}}</td>
    </tr>
{{end}}
</table>
{{end}}

{{if .NegativeTests.UnresolvedRequestsNumber}}
<h3>Unresolved Test Cases</h3>

<p>{{.NegativeTests.UnresolvedRequestsNumber}} requests identified as blocked and passed or as not-blocked and not-passed</p>

<table>
    <tr>
        <th>Payload</th>
        <th>Test case</th>
        <th>Encoder</th>
        <th>Placeholder</th>
        <th>Status</th>
    </tr>
{{range $row := .NegativeTests.Unresolved}}
    <tr>
        <td><code>{{$row.Payload}}</code></td>
        <td>{{$row.TestCase}}</td>
        <td>{{$row.Encoder}}</td>
        <td>{{$row.Placeholder}}</td>
        <td>{{$row.Status}}</td>
    </tr>
{{end}}
</table>
{{end}}

{{if .NegativeTests.FailedRequestsNumber}}
<h3>Failed Requests</h3>

<p>{{.NegativeTests.FailedRequestsNumber}} failed requests</p>

<table>
    <tr>
        <th>Payload</th>
        <th>Test case</th>
        <th>Encoder</th>
        <th>Placeholder</th>
    </tr>
{{range $row := .NegativeTests.Failed}}
    <tr>
        <td><code>{{$row.Payload}}</code></td>
        <td>{{$row.TestCase}}</td>
        <td>{{$row.Encoder}}</td>
        <td>{{$row.Placeholder}}</td>
    </tr>
    <tr>
        <td colspan="4">{{$row.Reason}}</td>
    </tr>
{{end}}
</table>
{{end}}

</body>
</html>
